<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#007bff" />
  <title>Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸ TPL</title>

  <link rel="stylesheet" href="style.css" />

  <link rel="icon" type="image/png" sizes="192x192" href="tpl-logo.png" />
  <link rel="apple-touch-icon" href="tpl-logo.png" />
  <link rel="manifest" href="manifest.json" />
</head>

<body>
  <div class="overlay" id="overlay" aria-hidden="true"></div>

  <nav class="side-menu" id="side-menu" aria-hidden="true">
    <div class="side-menu-header">
      <img src="tpl-logo.png" alt="Ğ›Ğ¾Ğ³Ğ¾Ñ‚Ğ¸Ğ¿ TPL" class="side-logo" />
      <button id="menu-close" class="menu-close" aria-label="Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¼ĞµĞ½Ñ">âœ•</button>
    </div>

    <ul class="side-links">
      <li><a href="index.html" class="side-link" id="side-link-calendar">ğŸ—“ï¸ Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ</a></li>
      <li><a href="instructions.html" class="side-link" id="side-link-instructions">ğŸ“– Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸</a></li>
    </ul>

    <div class="side-actions">
      <button class="side-action-btn" id="side-theme-toggle" aria-label="Changer de thÃ¨me">
        <span class="icon-light">â˜€ï¸</span>
        <span class="icon-dark">ğŸŒ™</span>
      </button>

      <button class="side-action-btn" id="side-lang-toggle" aria-label="Changer de langue">
        ğŸ‡«ğŸ‡·
      </button>
    </div>
  </nav>

  <div class="offline-banner hidden" id="offline-banner" aria-live="polite">
    <p id="offline-message">âŒ Hors ligne. Le contenu affichÃ© n'est pas Ã  jour.</p>
  </div>

  <header>
    <div class="header-container">
      <button id="menu-btn" class="menu-btn" aria-label="Ouvrir le menu">â˜°</button>
      <h1 id="main-title">Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ</h1>
      <button id="lang-toggle" class="lang-toggle" aria-label="Changer de langue">ğŸ‡«ğŸ‡·</button>
    </div>
  </header>

  <main class="content-container">
    <h2 id="section1-title">Comment ajouter un Ã©vÃ©nement ?</h2>
    <p id="section1-text">
      L'ajout d'un Ã©vÃ©nement se fait directement sur le planning.
    </p>

    <h3 id="step1-title">Ã‰tape 1 : Choisir la date</h3>
    <p id="step1-text">
      Cliquez ou tapez sur le jour/l'heure souhaitÃ©(e) dans la vue du planning. Un pop-up apparaÃ®tra.
    </p>

    <h3 id="step2-title">Ã‰tape 2 : Remplir les informations</h3>
    <p id="step2-text">
      Dans le pop-up, remplissez :
    </p>
    <ul id="step2-list">
      <li>**Titre** : Votre nom et prÃ©nom. (Exemple : "Jean DUPONT")</li>
      <li>**DÃ©but** : L'heure de dÃ©but de votre service.</li>
      <li>**Fin** : L'heure de fin de votre service.</li>
      <li>**CatÃ©gorie** : Le lieu de votre permanence (HÃ´tel-Dieu, PrÃ©fecture, etc.).</li>
    </ul>

    <h3 id="step3-title">Ã‰tape 3 : Enregistrer</h3>
    <p id="step3-text">
      Cliquez sur **Â« Enregistrer Â»**. Votre Ã©vÃ©nement est maintenant visible par tous.
      Vous pouvez cliquer dessus pour le modifier ou le supprimer.
    </p>
    <ul id="step3-list">
      <li>Assurez-vous d'Ãªtre connectÃ© Ã  Internet pour que votre modification soit enregistrÃ©e sur le serveur.</li>
      <li>Si vous Ãªtes hors ligne, l'Ã©vÃ©nement sera enregistrÃ© localement et synchronisÃ© dÃ¨s que possible.</li>
    </ul>

    <div class="map-container">
      <h2 id="map-title">Carte des lieux de permanence TPL</h2>
      <p id="map-text">
        Vous trouverez ici la carte interactive Umap des lieux rÃ©currents d'intervention de TPL.
        Elle peut Ãªtre basculÃ©e en mode sombre pour une meilleure lisibilitÃ©.
      </p>
      <iframe 
        src="//umap.openstreetmap.fr/fr/map/points-tpl-nantes-russe_1315005?scaleControl=false&miniMap=false&scrollWheelZoom=false&zoomControl=true&editMode=disabled&moreControl=true&searchControl=null&tilelayersControl=null&embedControl=null&datalayersControl=true&onLoadPanel=none&captionBar=false&captionMenus=true" 
        width="100%" height="450px" frameborder="0" allowfullscreen>
      </iframe>
      <button id="fullscreen-map">Agrandir la carte</button>
    </div>

    <h2 id="tips-title">Conseils rapides</h2>
    <p id="tips-text">
      **Mode Sombre (Dark Mode)** : Utilisez le bouton ğŸŒ™ pour basculer en mode sombre. Ce rÃ©glage est conservÃ©.
      <br>
      **Mode Hors Ligne** : L'application fonctionne sans connexion. Les donnÃ©es sont mises en cache et les modifications sont synchronisÃ©es plus tard.
    </p>
  </main>

  <script>
    const translations = {
      fr: {
        title: "Instructions TPL",
        mainTitle: "Instructions d'utilisation",
        section1Title: "Comment ajouter un Ã©vÃ©nement ?",
        section1Text: "L'ajout d'un Ã©vÃ©nement se fait directement sur le planning.",
        step1Title: "Ã‰tape 1 : Choisir la date",
        step1Text: "Cliquez ou tapez sur le jour/l'heure souhaitÃ©(e) dans la vue du planning. Un pop-up apparaÃ®tra.",
        step2Title: "Ã‰tape 2 : Remplir les informations",
        step2Text: "Dans le pop-up, remplissez :",
        step2Items: [
          "**Titre** : Votre nom et prÃ©nom. (Exemple : \"Jean DUPONT\")",
          "**DÃ©but** : L'heure de dÃ©but de votre service.",
          "**Fin** : L'heure de fin de votre service.",
          "**CatÃ©gorie** : Le lieu de votre permanence (HÃ´tel-Dieu, PrÃ©fecture, etc.)."
        ],
        step3Title: "Ã‰tape 3 : Enregistrer",
        step3Text: "Cliquez sur **Â« Enregistrer Â»**. Votre Ã©vÃ©nement est maintenant visible par tous. Vous pouvez cliquer dessus pour le modifier ou le supprimer.",
        step3Items: [
          "Assurez-vous d'Ãªtre connectÃ© Ã  Internet pour que votre modification soit enregistrÃ©e sur le serveur.",
          "Si vous Ãªtes hors ligne, l'Ã©vÃ©nement sera enregistrÃ© localement et synchronisÃ© dÃ¨s que possible."
        ],
        mapTitle: "Carte des lieux de permanence TPL",
        mapText: "Vous trouverez ici la carte interactive Umap des lieux rÃ©currents d'intervention de TPL. Elle peut Ãªtre basculÃ©e en mode sombre pour une meilleure lisibilitÃ©.",
        fullscreenMap: "Agrandir la carte",
        tipsTitle: "Conseils rapides",
        tipsText: "**Mode Sombre (Dark Mode)** : Utilisez le bouton ğŸŒ™ pour basculer en mode sombre. Ce rÃ©glage est conservÃ©. Mode Hors Ligne : L'application fonctionne sans connexion. Les donnÃ©es sont mises en cache et les modifications sont synchronisÃ©es plus tard.",
        sideLinkCalendar: "ğŸ—“ï¸ Calendrier", // Ajout
        sideLinkInstructions: "ğŸ“– Instructions", // Ajout
      },
      ru: {
        title: "Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸ TPL",
        mainTitle: "Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ",
        section1Title: "ĞšĞ°Ğº Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ?",
        section1Text: "Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ÑÑ Ğ¿Ñ€ÑĞ¼Ğ¾ Ğ² Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğ¸.",
        step1Title: "Ğ¨Ğ°Ğ³ 1: Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ´Ğ°Ñ‚Ñƒ",
        step1Text: "ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ¸Ğ»Ğ¸ ĞºĞ¾ÑĞ½Ğ¸Ñ‚ĞµÑÑŒ Ğ¶ĞµĞ»Ğ°ĞµĞ¼Ğ¾Ğ³Ğ¾ Ğ´Ğ½Ñ/Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ² ĞºĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€Ğµ. ĞŸĞ¾ÑĞ²Ğ¸Ñ‚ÑÑ Ğ²ÑĞ¿Ğ»Ñ‹Ğ²Ğ°ÑÑ‰ĞµĞµ Ğ¾ĞºĞ½Ğ¾.",
        step2Title: "Ğ¨Ğ°Ğ³ 2: Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ",
        step2Text: "Ğ’Ğ¾ Ğ²ÑĞ¿Ğ»Ñ‹Ğ²Ğ°ÑÑ‰ĞµĞ¼ Ğ¾ĞºĞ½Ğµ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ:",
        step2Items: [
          "**ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ** : Ğ’Ğ°ÑˆĞ¸ Ğ¸Ğ¼Ñ Ğ¸ Ñ„Ğ°Ğ¼Ğ¸Ğ»Ğ¸Ñ. (ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: \"Ğ˜Ğ²Ğ°Ğ½ Ğ˜Ğ’ĞĞĞĞ’\")",
          "**ĞĞ°Ñ‡Ğ°Ğ»Ğ¾** : Ğ’Ñ€ĞµĞ¼Ñ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ğ´ĞµĞ¶ÑƒÑ€ÑÑ‚Ğ²Ğ°.",
          "**ĞšĞ¾Ğ½ĞµÑ†** : Ğ’Ñ€ĞµĞ¼Ñ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ñ Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ğ´ĞµĞ¶ÑƒÑ€ÑÑ‚Ğ²Ğ°.",
          "**ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ** : ĞœĞµÑÑ‚Ğ¾ Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ğ´ĞµĞ¶ÑƒÑ€ÑÑ‚Ğ²Ğ° (HÃ´tel-Dieu, PrÃ©fecture Ğ¸ Ñ‚. Ğ´.)."
        ],
        step3Title: "Ğ¨Ğ°Ğ³ 3: Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ",
        step3Text: "ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ **Â«Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒÂ»**. Ğ’Ğ°ÑˆĞµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ñ‚ĞµĞ¿ĞµÑ€ÑŒ Ğ²Ğ¸Ğ´Ğ½Ğ¾ Ğ²ÑĞµĞ¼. Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ½Ğ°Ğ¶Ğ°Ñ‚ÑŒ Ğ½Ğ° Ğ½ĞµĞ³Ğ¾, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ.",
        step3Items: [
          "Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ Ğ²Ñ‹ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹ Ğº Ğ˜Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚Ñƒ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ²Ğ°ÑˆĞ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ±Ñ‹Ğ»Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ñ‹ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€Ğµ.",
          "Ğ•ÑĞ»Ğ¸ Ğ²Ñ‹ Ğ½Ğµ Ğ² ÑĞµÑ‚Ğ¸, ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ğ±ÑƒĞ´ĞµÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¾ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ Ğ¸ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸."
        ],
        mapTitle: "ĞšĞ°Ñ€Ñ‚Ğ° Ğ¼ĞµÑÑ‚ Ğ´ĞµĞ¶ÑƒÑ€ÑÑ‚Ğ² TPL",
        mapText: "Ğ—Ğ´ĞµÑÑŒ Ğ²Ñ‹ Ğ½Ğ°Ğ¹Ğ´ĞµÑ‚Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½ÑƒÑ ĞºĞ°Ñ€Ñ‚Ñƒ Umap Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ñ‹Ñ… Ğ¼ĞµÑÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ TPL. Ğ•Ğµ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ² Ñ‚ĞµĞ¼Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼ Ğ´Ğ»Ñ Ğ»ÑƒÑ‡ÑˆĞµĞ¹ Ñ‡Ğ¸Ñ‚Ğ°ĞµĞ¼Ğ¾ÑÑ‚Ğ¸.",
        fullscreenMap: "Ğ Ğ°Ğ·Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ ĞºĞ°Ñ€Ñ‚Ñƒ",
        tipsTitle: "ĞšÑ€Ğ°Ñ‚ĞºĞ¸Ğµ ÑĞ¾Ğ²ĞµÑ‚Ñ‹",
        tipsText: "**Ğ¢ĞµĞ¼Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼ (Dark Mode)** : Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ ğŸŒ™ Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ² Ñ‚ĞµĞ¼Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼. Ğ­Ñ‚Ğ° Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ÑÑ. ĞĞ²Ñ‚Ğ¾Ğ½Ğ¾Ğ¼Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼ : ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ. Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ ĞºÑÑˆĞ¸Ñ€ÑƒÑÑ‚ÑÑ, Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ¿Ğ¾Ğ·Ğ¶Ğµ.",
        sideLinkCalendar: "ğŸ—“ï¸ Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ", // Ajout
        sideLinkInstructions: "ğŸ“– Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸", // Ajout
      }
    };

    function updateInstructionsLanguage(lang) {
      const t = translations[lang]; // Simplification
      
      document.title = t.title;
      document.getElementById("main-title").textContent = t.mainTitle;
      document.getElementById("section1-title").textContent = t.section1Title;
      document.getElementById("section1-text").textContent = t.section1Text;
      document.getElementById("step1-title").textContent = t.step1Title;
      document.getElementById("step1-text").textContent = t.step1Text;
      document.getElementById("step2-title").textContent = t.step2Title;
      document.getElementById("step2-text").textContent = t.step2Text;

      const step2List = document.getElementById("step2-list");
      step2List.innerHTML = "";
      t.step2Items.forEach(item => { const li = document.createElement("li"); li.innerHTML = item; step2List.appendChild(li); }); // Utilisation de innerHTML pour le gras

      document.getElementById("step3-title").textContent = t.step3Title;
      document.getElementById("step3-text").textContent = t.step3Text;
      const step3List = document.getElementById("step3-list");
      step3List.innerHTML = "";
      t.step3Items.forEach(item => { const li = document.createElement("li"); li.innerHTML = item; step3List.appendChild(li); }); // Utilisation de innerHTML pour le gras
      
      document.getElementById("map-title").textContent = t.mapTitle;
      document.getElementById("map-text").textContent = t.mapText;
      document.getElementById("fullscreen-map").textContent = t.fullscreenMap;
      document.getElementById("tips-title").textContent = t.tipsTitle;
      document.getElementById("tips-text").innerHTML = t.tipsText; // Utilisation de innerHTML pour le gras/saut de ligne
      
      // Mise Ã  jour des drapeaux (CorrigÃ©)
      const flag = lang === "fr" ? "ğŸ‡«ğŸ‡·" : "ğŸ‡·ğŸ‡º";
      document.getElementById("lang-toggle").textContent = flag;
      document.getElementById("side-lang-toggle").textContent = flag;

      // Mise Ã  jour des liens du menu latÃ©ral (AjoutÃ©)
      document.getElementById("side-link-calendar").textContent = t.sideLinkCalendar;
      document.getElementById("side-link-instructions").textContent = t.sideLinkInstructions;
    }

    function toggleLanguage() {
      // Logique pour basculer la langue correctement
      const newLang = document.documentElement.lang === "fr" ? "ru" : "fr";
      document.documentElement.lang = newLang;
      updateInstructionsLanguage(newLang);
    }

    document.getElementById("lang-toggle").addEventListener("click", toggleLanguage);
    document.getElementById("side-lang-toggle").addEventListener("click", toggleLanguage);

    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js")
        .then(() => console.log("âœ… Service Worker Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½"))
        .catch(err => console.error("âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Service Worker :", err));
    }

    // Applique la traduction initiale basÃ©e sur l'attribut lang (ru dans ce cas)
    updateInstructionsLanguage(document.documentElement.lang);
  </script>
</body>
</html>
